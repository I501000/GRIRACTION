#!/usr/bin/env node
'use strict';

var _ = require('lodash');
var shell = require('./shell');

module.exports = test;

function test(options, cmdC8Arguments, cmdArguments) {
  var cmd = 'c8 ' + prepareArguments(cmdC8Arguments) +
      ' node_modules/mocha/bin/_mocha test '
      + prepareArguments(cmdArguments);
  if (process.env.REPORTER) {
    cmd += ' -R ' + process.env.REPORTER;
  }

  shell(cmd, options);
}

function prepareArguments(cmdArguments) {
  cmdArguments = cmdArguments || '';
  if (!_.isString(cmdArguments)) {
    throw new Error('Provided command line arguments should be a string');
  }
  return cmdArguments;
}

if (require.main === module) {
  test();
}
