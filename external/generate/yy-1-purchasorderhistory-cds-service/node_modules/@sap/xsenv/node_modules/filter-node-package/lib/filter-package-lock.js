'use strict';

var _ = require('lodash');

module.exports = {
  filterPackageLock: function (packageLock, options) {
    filter(packageLock.dependencies, options);
  },
  filterDev: function (packageLock) {
    removeDevDeps(packageLock.dependencies);
  }
}

function filter(dependencies, options) {
  _.forOwn(dependencies, function (dep) {
    delete dep.resolved;
    delete dep.from;
    if (options.integrity) {
      delete dep.integrity;
    }
    filter(dep.dependencies, options);
  });
}

function removeDevDeps(dependencies) {
  _.forOwn(dependencies, function (value, key) {
    if (value.dev) {
      delete dependencies[key];
    }
  });
}
